<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/x-icon" href=" {{ url_for('static', filename='images/favicon.ico') }} ">
		<link rel="stylesheet" href=" {{ url_for('static', filename='styles/main.css')}} ">
		<title>Search results for {{ query }}</title>
	</head>

	<body>
		<h2> You searched for: {{ query }}</h2>
		<table>
			<thead>
				<tr>
					<th>Name</th>
					<th>Release Year</th>
					<th>Publishers</th>
				</tr>
			</thead>
			<tbody>
				{% for n, r, p, gid, img in results %}
				<tr>
					<td><div class="thumb"><img src="{{ img }}"/></div>>{{n}}</td>
					<td>{{r}}</td>
					<td>{{p}}</td>
					<td>
						<form method="post" action="{{ url_for('entry') }}">
							<input style="display:none" type="text" name="gid" value="{{ gid }}">
							<input type="submit" value="Info"/>
						</form>
					</td>
				</tr>
				{% endfor %}
			</tbody>
		</table>
		<form method="post" action="{{ url_for('results') }}">
      <input style="display: none;" type="text" value="{{ p - 1 }}" name="pp">
      <input style="display: none;" type="text" value="{{ query }}" name="searchterm">
			<input id="pp" type="submit" value="{{ p - 1  }}" />
    </form>
    <p>{{ p }}</p>
    <form method="post" action="{{ url_for('results') }}">
      <input style="display: none;" type="text" value="{{ p + 1 }}" name="np">
      <input style="display: none;" type="text" value="{{ query }}" name="searchterm">
			<input id="np" type="submit" value="{{ p + 1 }}" />
		</form>
		<form method="post" action="{{ url_for('index') }}">
			<input type="submit" value="Search Page" />
    </form>
    <script type="text/javascript">
      const results = {{ data|tojson|safe }}
      document.addEventListener("DOMContentLoaded", () => {
        if (document.querySelectorAll('tbody>tr').length < 20) { np.style = "display:none" }
        if (pp.value == '0') { pp.style = "display:none" }
        timeline();
      })
      const timeline = () => {
        sortedDates = results.map(a => a[1]).sort()
        oldest = sortedDates[0]
        recent = sortedDates[results.length-1]
        unique = [...new Set(sortedDates)]
      }
    </script>
	</body>	
</html>