<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="icon" type="image/x-icon" href=" {{ url_for('static', filename='images/favicon.ico') }} ">
		<link rel="stylesheet" href=" {{ url_for('static', filename='styles/main.css')}} ">
		<title>Search results for {{ query }}</title>
	</head>
	<body>
    <header>
      <form method="get" action="{{ url_for('results') }}">
        <input tabindex="1" type="text" name="searchterm" value ="{{ query }}"/>
        <div class="checks">
          <label class="chk">Name<input tabindex="2" type=checkbox name="name" checked/><span></span></label>
          <label class="chk">Year<input tabindex="3" type=checkbox name="release_year" checked/><span></span></label>
          <label class="chk">Developers<input tabindex="4" type=checkbox name="developers" checked/><span></span></label>
          <label class="chk">Publishers<input tabindex="5" type=checkbox name="publishers" checked/><span></span></label>
          <label class="chk">Genres<input tabindex="6" type=checkbox name="genres" checked/><span></span></label>
          <label class="chk">Description<input tabindex="7" type=checkbox name="description" checked/><span></span></label>
          <label class="chk">Consoles<input tabindex="8" type=checkbox name="consoles" checked/><span></span></label>
        </div>
				<input class="butt" type="submit" value="Search now"/>
    </form>
    <form method="post" action="{{ url_for('index') }}">
      <input class="butt" type="submit" value="Go Home" />
    </form>
  </header>
  <div id="main">
    <div id="resultsWrapper">
        {% for n, r, p, gid, img in results %}
        <div class="result">
          <div class="info">
            <div class="details">
              <div class="name">{{n}}</div>
              <div class="year">Released in {{r}}</div>
              <div class="publ">Published by {{p}}</div>
            </div>
            <div class="buttons">
              <form method="post" action="{{ url_for('entry') }}">
                <input style="display:none" type="text" name="gid" value="{{ gid }}">
                <button class="butt" type="button" gid="{{ gid }}" id="share" onclick="Share(this)">Share</button>
                <label class="butt" ><input type="submit" value="Info"/></label>
              </form>
              <form method="get" action="{{ url_for('results') }}">
                <label style="display:none"><input type="text" value="related:{{ gid }}" name="searchterm"/></label>
                <label class="butt" ><input type="submit" value="Related Games"/></label>
              </form>
            </div>
          </div>
		  <!--the timeline will grab this element b/c of the id=gid attribute-->
          <a href="{{ url_for('entry') }}?gid={{ gid }}" class="thumb" id="{{ gid }}"><img src="{{ img }}"  onerror="this.src = '/static/images/missing_image.png'"/></a>
        </div>
        {% endfor %}
      </div>
      <aside><canvas id="timeLine"></canvas></aside>
    </div>
  </div>
    <div class="pages">
      <form method="post" action="{{ url_for('results') }}">
        <input style="display: none;" type="text" value="{{ p - 1 }}" name="pp">
        <input style="display: none;" type="text" value="{{ query }}" name="searchterm">
        <input id="pp" type="submit" value="{{ p - 1  }}" />
      </form>
      <p>{{ p }}</p>
      <form method="post" action="{{ url_for('results') }}">
        <input style="display: none;" type="text" value="{{ p + 1 }}" name="np">
        <input style="display: none;" type="text" value="{{ query }}" name="searchterm">
      <input id="np" type="submit" value="{{ p + 1 }}" />
    </form>
    </div>
    <!-- Use this script tage to store data you wanna pass using jinja -->
    <script type="text/javascript">
      const results = {{ data|tojson|safe }}
      ;const Share = (el) => { navigator.clipboard.writeText(`${window.location.host}/entry/?gid=${el.getAttribute("gid")}`) }
    </script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/app.js') }}"></script>
	</body>	
</html>